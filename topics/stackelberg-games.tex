\section{Stackelberg games}

Stackelberg games model hierarchical decision-making where the
\textbf{leader} (Player 1) commits to a strategy first, and the
\textbf{follower} (Player 2) observes and best-responds.

Let $\mathcal{Y}$ and $\Sigma$ be the strategy spaces (pure or
mixed), and $J_i(y, \sigma)$ the cost for Player $i$.

\subsection{Definition of Stackelberg games}

\subsection{Definitions and Core Concepts}

\textbf{Rational Reaction Set}
For leader strategy $y \in \mathcal{Y}$
and $\forall \xi \in \Sigma$
the follower's rational reaction set is:
\[
  R(y) = \arg\min_{\sigma \in \Sigma} J_2(y, \sigma) = \{\sigma \in
    \Sigma \mid J_2(y, \sigma) \leq J_2(y, \xi)
  \]

  \begin{sstTitleBox}{Stackelberg Equilibrium}
    \begin{sstOnlyFrame}
      A pair $(\tilde{y}, \tilde{\sigma}(\cdot))$ with $\tilde{y} \in
      \mathcal{Y}$ and $\tilde{\sigma}: \mathcal{Y} \to \Sigma$ is a
      Stackelberg equilibrium if:
      \begin{itemize}
        \item Leader optimizes: $\tilde{y} \in \arg\min_{y \in
          \mathcal{Y}} J_1(y, \tilde{\sigma}(y))$.
        \item Follower best-responds: $\tilde{\sigma}(y) \in R(y)$ for
          all $y \in \mathcal{Y}$.
      \end{itemize}
      In zero-sum games, this coincides with the minimax (security) strategy.
    \end{sstOnlyFrame}
  \end{sstTitleBox}

  Applications include oligopoly models
  (e.g., Cournot quantity competition where leader gains advantage by
    committing first, yielding higher profit than simultaneous Nash;
    Bertrand price competition where leader may face disadvantage due
  to aggressive follower response).

  \subsection{Stackelberg Zero-Sum Games}

  In zero-sum games ($J_2 = -J_1$),
  Stackelberg equilibria equal mixed Nash equilibria,
  with value
  \[
    v = \min_y \max_\sigma J_1(y, \sigma) = \max_\sigma \min_y J_1(y, \sigma)
  \]
  No commitment advantage/disadvantage.

  \subsubsection{Mixed Security Strategy}

  Leader's mixed security strategy:
  \[
    \tilde{y} \in
    \arg\min_{y \in \mathcal{Y}} \max_{\sigma \in \Sigma} J_1(y, \sigma)
  \]

  \subsubsection{Pure Security Strategy}

  Restrict to pure strategies:
  \[
    \tilde{y} \in \arg\min_{y \in Y} \max_{\sigma \in S} J_1(y, \sigma)
  \]
  often worse than mixed.

  \subsubsection{Stackelberg vs. Nash}

  Mixed Stackelberg and Nash coincide in zero-sum games.\\
  Pure Stackelberg may differ and be suboptimal.

  \subsection{Stackelberg Non-Zero-Sum Games}

  \begin{sstTitleBox}{Highest Leader Cost (Pessimistic)}
    \begin{sstOnlyFrame}
      \[H = \inf_y \max_{\sigma \in R(y)} J_1(y, \sigma)\]
      always achievable in equilibrium.
    \end{sstOnlyFrame}
    \begin{sstOnlyFrame}
      \begin{theorem}[Upper Bound on Stackelberg Cost]
        No equilibrium achieves $J_1 < H$.
      \end{theorem}
    \end{sstOnlyFrame}
  \end{sstTitleBox}

  \begin{theorem}[Nash vs. Highest Leader Cost]
    Every Nash equilibrium $(y^*, \sigma^*)$ satisfies $J_1(y^*,
    \sigma^*) \geq H$; Stackelberg is never worse for leader than any NE.
  \end{theorem}

  \begin{sstTitleBox}{Lowest Leader Cost (Optimistic)}
    \begin{sstOnlyFrame}
      \[
        L = \min_y \min_{\sigma \in R(y)} J_1(y, \sigma)
      \]
      generically $L = H$ for random payoffs.
    \end{sstOnlyFrame}
    \begin{sstOnlyFrame}
      \begin{theorem}[Nash vs. Lowest Leader Cost]
        Every Nash equilibrium satisfies $J_1(y^*, \sigma^*) \geq L$.
      \end{theorem}
    \end{sstOnlyFrame}
  \end{sstTitleBox}

  Pure-strategy Stackelberg: $H_\text{pure}$ can exceed Nash costs if
  rational reaction sets are non-singleton.

  \subsubsection{Computation of Stackelberg Equilibrium}

  For finite games, use divide-and-conquer: For each pure follower
  strategy $\sigma_j$, solve LP
  \[
    \min_y y^\top A_j \quad \text{s.t.} \quad y^\top B_k \geq y^\top
    B_j \ \forall k \neq j, \ y \in \Delta^m,
  \]
  where $A_j, B_k$ are payoff vectors. Select minimum $J_1$ among
  solutions. Easier than Nash computation.

  \subsection{Security Games}

  Defender (leader) randomizes coverage over targets; attacker
  (follower) observes and attacks optimally. Coverage vector $c =
  X^\top y$, where $X$ is target-schedule matrix.

  \begin{definition}[Coverage Vector]
    $c_t = \sum_s x_{s,t} y_s$, probability target $t$ is covered.
  \end{definition}

  Stackelberg solution via LP; provides commitment advantage over Nash.

  \subsubsection{Stackelberg Solution}
  Minimize expected damage via LP over mixed $y$, assuming attacker
  best-responds.

  \subsubsection{Nash Equilibria}
  Equivalent to NE of auxiliary zero-sum game
  (set defender payoff = -attacker payoff).
  All NE attacker-equivalent.
  If feasible coverages downward-closed
  ($\gamma' \leq \gamma \in \Gamma \implies \gamma' \in \Gamma$),
  every Stackelberg strategy is Nash.

  \examBox{Exam Relevance}
  {Focus on equilibrium computation (LP), zero/non-zero-sum
    differences, leader advantage (e.g., Cournot/Bertrand), security
  games (auxiliary zero-sum, downward-closed sets)}

